<div id="portal-slider"
     class="principal"
     role="complementary"
     tal:define="banners view/random_banner | nothing;
                 portal context/@@plone_portal_state/portal;
                 context_state context/@@plone_context_state;
                 checkPermission python:context.restrictedTraverse('portal_membership').checkPermission;
                 can_edit python:checkPermission('Modify portal content', context);"
     tal:condition="python: banners"
     tal:attributes="class python: view.scroll and 'scrollable principal' or 'principal';"
     i18n:domain="collective.behavior.banner">

 <div class="container">
  <div class="gigantic">

    <div id="carousel"
         class="carousel slide"
         data-ride="carousel"
         tal:attributes="id python: 'carousel_' + context.id">

      <!-- Indicators -->
      <ol class="carousel-indicators hidden-xs">
          <li data-target="#carousel"
              tal:repeat="banner banners"
              tal:attributes="data-target python: '#carousel_' + context.id"
              data-slide-to="${python:repeat.banner.index}"
              class="${python: repeat.banner.start and 'active' or ''}"></li>
          <button class="flickity-play-button-container flickity-play-button paused"></button>
      </ol>

      <div class="carousel-inner" role="listbox">

        <tal:loop tal:repeat="banner banners">

            <div class="portal-banner item ${python: repeat.banner.start and 'active' or ''}"
                 tal:define="has_image python:'banner_image' in banner;
                             has_url python:banner and 'banner_url' in banner;
                             has_fontcolor python:'banner_fontcolor' in banner;
                             hide_other_banner python: repeat.banner.start and '' or 'display: none';
                             fontcolor python:has_fontcolor and banner['banner_fontcolor'] + ' !important' or '#ffffff';"
                tal:attributes="style hide_other_banner">

                <div class="bannerImage"
                     tal:condition="python:has_image">
                        <img class="bannerImageImage"
                             tal:attributes="src string:${banner/banner_image};
                                             alt banner/banner_alt">
                </div>

                <div class="bannerVideo"
                     tal:condition="python:has_url and not has_image">
                    <tal:iframe define="url banner/banner_url"
                      replace="structure python:view.getVideoEmbedMarkup(url)">
                    </tal:iframe>
                </div>

                <div class="bannerContent frame">
                    <div class="bannerText"
                         tal:attributes="class python: 'bannerText ' + banner['textblock_css_class']">

                        <h1 class="bannerTitle"
                             tal:condition="python:'banner_title' in banner">
                            <span tal:replace="banner/banner_title">Title</span>
                        </h1>

                        <p class="bannerDescription"
                             tal:condition="python:'banner_description' in banner">
                            <tal:def tal:define="banner_desc banner/banner_description;">
                                <span tal:replace="banner_desc" />
                            </tal:def>
                        </p>

                        <div class="bannerLink"
                             tal:condition="python:'banner_link' in  banner and 'banner_linktext' in banner">

                            <a href="" title="" tal:attributes="href banner/banner_link; title banner/banner_linktext"
                                                tal:content="banner/banner_linktext">
                                Link
                            </a>

                        </div>

                        <div class="bannerBody"
                           tal:condition="python:'banner_text' in banner">
                           <span tal:replace="structure banner/banner_text">
                                 Text
                           </span>
                        </div>

                    </div>

                    <div class="bannerEdit"
                         tal:condition="python: can_edit">
                        <ul>
                            <li>
                                <a href=""
                                    tal:attributes="href python: context.absolute_url() + '/++add++banner'">
                                    Add slider
                                </a>
                            </li>
                            <li>
                                <a href=""
                                    tal:attributes="href python: banner['banner_obj'].absolute_url() + '/@@edit'">
                                    Edit this slider
                                </a>
                            </li>
                            <li>
                                <a href=""
                                    tal:attributes="href python: context.absolute_url() + '/folder_contents'">
                                    Manage sliders
                                </a>
                            </li>
                        </ul>
                    </div>

                </div>

            </div>

        </tal:loop>

      </div>

    </div>

  </div>
 </div>

</div>
